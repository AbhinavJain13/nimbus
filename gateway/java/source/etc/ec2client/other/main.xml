<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

    <!-- ===================================================================
         rm.Manager implementation
         =================================================================== -->

    <bean id="nimbus-rm.manager"
          class="org.nimbustools.gateway.ec2.manager.EC2GatewayManager">
        
        <constructor-arg ref="nimbus-rm.creation" />
    </bean>


    <!-- ===================================================================
         Creation interfaces
         =================================================================== -->

    <bean id="nimbus-rm.creation"
          class="org.nimbustools.gateway.ec2.creation.defaults.DefaultCreation">

    </bean>


    <!-- ===================================================================
         rm.BasicLegality implementation (using nimbustools default)
         =================================================================== -->

    <bean id="nimbus-rm.BasicLegality"
          class="org.nimbustools.api.defaults.services.rm.DefaultBasicLegality" />

    
    <!-- ===================================================================
         brain.ModuleLocator implementation

         For use from above to find key modules, where "above" in almost all
         cases means a container (the remote messaging layer).  Those cannot be
         served by dependency injection (or if they happened to be, would be a
         different application context unless you took time to integrate
         directly).
         =================================================================== -->

    <bean id="nimbus-brain.ModuleLocator"
          class="org.nimbustools.api.defaults.brain.DefaultModuleLocator">

        <lookup-method name="getManager" bean="nimbus-rm.manager"/>
        <lookup-method name="getReprFactory" bean="nimbus-repr.ReprFactory"/>
        <lookup-method name="getMetadataServer" bean="nimbus-metadata-server"/>

    </bean>


    <!-- ===================================================================
         representation classes are broken out
         =================================================================== -->

    <import resource="main.repr.xml"/>


    <!-- ===================================================================
         property sources are concentrated in this file
         =================================================================== -->

    <import resource="main.conflocator.xml"/>


    <!-- ===================================================================
         metadata server is a no-op in the gateway
         =================================================================== -->

    <bean id="nimbus-metadata-server"
          class="org.nimbustools.api.defaults.services.metadata.DefaultMetadataServer" />

</beans>
